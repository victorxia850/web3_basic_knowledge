# 比特币中的密码学技术

比特币依赖密码学原语，确保在去中心化系统中的安全性、信任性和完整性。其中最关键的两项技术是 **哈希函数** 和 **数字签名**。

---

## 一、哈希函数

密码学哈希函数用于将任意长度的输入映射为固定长度的输出。它在比特币中被广泛用于区块构建、交易完整性校验以及挖矿。

### 1.1 抗碰撞性（Collision Resistance）

> 几乎不可能找到两个不同的输入 $x_1 \neq x_2$，使得 $H(x_1) = H(x_2)$。

**在比特币中的应用**：防止数据篡改。任何交易数据的变化都会导致完全不同的哈希值。

### 1.2 隐秘性（Hiding）

> 给定 $H(x)$，几乎不可能反推出 $x$。

**增强方法**：使用随机盐值 $r$：$H(r || x)$ 来提高输入熵。

**在比特币中的应用**：保护敏感数据，防止通过哈希值推断原始内容。

### 1.3 谜题友好性（Puzzle Friendliness）

> 难以找到某个输入 $x$，使得 $H(x) < T$，其中 $T$ 是难度目标。

**在比特币中的应用**：挖矿——寻找一个 nonce，使得区块头哈希低于指定阈值。

#### 📊 哈希流程图

```text
[输入 (block header + nonce)] ---> [哈希函数 H()] ---> [输出哈希值]
                                              ↓
                                       是否满足 H < Target？
                                              ↓
                                        是 → 区块有效
                                        否 → 尝试下一个 nonce
```

---

## 二、数字签名

比特币采用非对称加密技术，确保只有私钥的拥有者才能授权一笔交易。

### 2.1 密钥对

* **私钥**：用于签署消息或交易。
* **公钥**：用于让网络中的其他节点验证签名。

### 2.2 签名流程

1. 使用发送方的私钥对交易数据进行签名。
2. 网络使用对应公钥验证该签名是否有效。
3. 验证成功，交易被接受。

#### 📊 签名验证流程图

```text
[发送者私钥] → [签署交易] → [签名]
                                     ↓
[交易 + 签名 + 公钥] → [验证签名]
                                     ↓
                               有效？ → 接受 / 拒绝
```

---

## 三、功能对比表

| 特性      | 哈希函数            | 数字签名    |
| ------- | --------------- | ------- |
| 主要作用    | 数据完整性、挖矿、防篡改    | 交易认证与授权 |
| 单向不可逆   | 是               | 否       |
| 是否涉及密钥对 | 否               | 是       |
| 应用场景    | 区块头、Merkle 树、挖矿 | 交易签名与验证 |

---

## 四、术语表

* **哈希函数**：将输入映射为定长输出的单向函数。
* **Nonce**：挖矿中用于变化哈希值的计数器。
* **Target**：哈希结果必须低于的目标值，用于控制难度。
* **私钥**：用于生成签名的秘密值。
* **公钥**：公开的值，用于验证签名。
* **签名**：私钥对消息的加密结果，用于证明交易所有权。

---

